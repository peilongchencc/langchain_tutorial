# Milvus

Milvus is a database that stores, indexes, and manages massive embedding vectors generated by deep neural networks and other machine learning (ML) models. <br>

Milvus æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œç”¨äºå­˜å‚¨ã€ç´¢å¼•å’Œç®¡ç†ç”±æ·±åº¦ç¥ç»ç½‘ç»œå’Œå…¶ä»–æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰æ¨¡å‹ç”Ÿæˆçš„å¤§è§„æ¨¡åµŒå…¥å‘é‡ã€‚<br>

This notebook shows how to use functionality related to the Milvus vector database.<br>

è¿™ä¸ªç¬”è®°æœ¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä¸ Milvus å‘é‡æ•°æ®åº“ç›¸å…³çš„åŠŸèƒ½ã€‚<br>

To run, you should have a Milvus instance up and running.<br>

ğŸ”¥ğŸ”¥ğŸ”¥è¦è¿è¡Œï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªå·²å¯åŠ¨å’Œè¿è¡Œçš„ Milvus å®ä¾‹ã€‚<br>

## Compartmentalize the data with Milvus Collections(ç”¨Milvusé›†åˆå¯¹æ•°æ®è¿›è¡Œåˆ†éš”):

You can store different unrelated documents in different collections within the same Milvus instance to maintain the context.<br>

æ‚¨å¯ä»¥åœ¨åŒä¸€ä¸ª Milvus å®ä¾‹ä¸­çš„ä¸åŒé›†åˆä¸­å­˜å‚¨ä¸ç›¸å…³çš„æ–‡æ¡£ï¼Œä»¥ä¿æŒä¸Šä¸‹æ–‡ã€‚<br>

Hereâ€™s how you can create a new collection.<br>

ä¸‹é¢æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–°é›†åˆçš„æ–¹æ³•ã€‚<br>

```python
vector_db = Milvus.from_documents(
    docs,
    embeddings,
    collection_name="collection_1",
    connection_args={"host": "127.0.0.1", "port": "19530"},
)
```

> å¦‚ä½•å®šä¹‰collectionçš„ç»“æ„ï¼ŒåŠ ä¸Šæ¥æºå­—æ®µï¼Ÿ

And here is how you retrieve that stored collection(ä»¥ä¸‹æ˜¯å¦‚ä½•æ£€ç´¢å­˜å‚¨çš„é›†åˆ):<br>

```python
vector_db = Milvus(
    embeddings,
    connection_args={"host": "127.0.0.1", "port": "19530"},
    collection_name="collection_1",
)
```

After retrieval you can go on querying it as usual.<br>

æ£€ç´¢åï¼Œæ‚¨å¯ä»¥åƒå¾€å¸¸ä¸€æ ·ç»§ç»­æŸ¥è¯¢å®ƒã€‚<br>


## Per-User Retrieval(ç”¨æˆ·æ£€ç´¢):

When building a retrieval app, you often have to build it with multiple users in mind.<br>

å½“æ„å»ºæ£€ç´¢åº”ç”¨ç¨‹åºæ—¶ï¼Œé€šå¸¸éœ€è¦è€ƒè™‘å¤šä¸ªç”¨æˆ·ã€‚<br>

This means that you may be storing data not just for one user, but for many different users, and they should not be able to see each otherâ€™s data.<br>

è¿™æ„å‘³ç€æ‚¨å¯èƒ½ä¸ä»…ä¸ºä¸€ä¸ªç”¨æˆ·å­˜å‚¨æ•°æ®ï¼Œè€Œæ˜¯ä¸ºè®¸å¤šä¸åŒçš„ç”¨æˆ·å­˜å‚¨æ•°æ®ï¼Œä»–ä»¬ä¸åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°å½¼æ­¤çš„æ•°æ®ã€‚<br>

Milvus recommends using partition_key to implement multi-tenancy, here is an example.<br>

Milvus å»ºè®®ä½¿ç”¨ partition_key å®ç°å¤šç§Ÿæˆ·ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç¤ºä¾‹ã€‚<br>

```python
from langchain_core.documents import Document

docs = [
    Document(page_content="i worked at kensho", metadata={"namespace": "harrison"}),
    Document(page_content="i worked at facebook", metadata={"namespace": "ankush"}),
]
vectorstore = Milvus.from_documents(
    docs,
    embeddings,
    connection_args={"host": "127.0.0.1", "port": "19530"},
    drop_old=True,
    partition_key_field="namespace",  # Use the "namespace" field as the partition key
)
```

> milvusä¸€ä¸ªé›†åˆå†…æœ€å¤šæ”¯æŒ4096ä¸ªåˆ†åŒºã€‚



åœ¨Markdownæ–‡æ¡£ä¸­ï¼Œè¦åˆ›å»ºä¸€ä¸ªå¯ç‚¹å‡»çš„é“¾æ¥ï¼Œè®©ç”¨æˆ·ç‚¹å‡»å°±å¯ä»¥è·³è½¬åˆ°å¦ä¸€ä¸ªç½‘é¡µï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„è¯­æ³•ï¼š

```markdown
[é“¾æ¥æ–‡å­—](ç½‘å€)
```

ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åˆ›å»ºä¸€ä¸ªæŒ‡å‘ Google çš„é“¾æ¥ï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š

```markdown
[è®¿é—®è°·æ­Œ](https://www.google.com)
```

è¿™æ ·ï¼Œå½“ç”¨æˆ·ç‚¹å‡»â€œè®¿é—®è°·æ­Œâ€æ—¶ï¼Œå°±ä¼šè·³è½¬åˆ° Google çš„é¦–é¡µã€‚è¿™ç§æ ¼å¼é€‚ç”¨äºå¤§å¤šæ•°Markdownç¼–è¾‘å™¨å’Œè§£æå™¨ï¼Œéå¸¸æ–¹ä¾¿ç”¨äºæ·»åŠ å¤–éƒ¨èµ„æºæˆ–å¼•ç”¨ã€‚